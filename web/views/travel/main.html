<div ng-include src="'views/header.html'"></div>
<div class="page-header">
	<h3>ข้อมูลกิจการโคนม  >  ข้อมูลการท่องเที่ยว</h3>
</div>
<div class="row form-group">
	<div class="col-lg-12">
		<button class="btn btn-danger pull-right" ng-click="goUpdate('')">
			<span class="glyphicon glyphicon-plus"></span> 
			บันทึกข้อมูลรายเดือน
		</button>
	</div>
</div>
<div class="row form-group">
	<div class="col-lg-12 text-center">
		<form name="search_form" class="form-inline">
	  		<div ng-show="condition.DisplayType == 'monthly'">
		  		<!--<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ภูมิภาค : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.Region" ng-options="region.RegionID as region.RegionName for region in PersonRegion" required="required">
				    	<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>-->
		  		<!--<div class="form-group">
				    <label for="exampleInputName2">&nbsp; การแสดงข้อมูล : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.DisplayType" ng-change="goSearch()">
						<option value="">กรุณาเลือก</option>
						<option value="monthly">รายเดือน</option>
						<option value="quarter">รายไตรมาส</option>
						<option value="annually">รายปี</option>
					</select>
			  	</div>-->
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; เดือน : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.MonthFrom" ng-options="month.monthValue as month.monthText for month in MonthList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>
				<!--<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ปี : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.YearFrom" ng-options="year.yearText as year.yearValue for year in YearList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>-->
			  	<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ถึง </label>
			  	</div>
			  	<div class="form-group">
				    <label for="exampleInputName2">&nbsp; เดือน : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.MonthTo" ng-options="month.monthValue as month.monthText for month in MonthList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ปี : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.YearTo" ng-options="year.yearText as year.yearValue for year in YearList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>
			  	<button class="btn btn-primary" ng-click="goSearch()"><span class="glyphicon glyphicon-search"></span> ค้นหา</button>
			</div>
			<div ng-show="condition.DisplayType == 'quarter'">
				<!--<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ภูมิภาค : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.Region" ng-options="region.RegionID as region.RegionName for region in PersonRegion" required="required">
				    	<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>-->
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; การแสดงข้อมูล : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.DisplayType" ng-change="goSearch()">
						<option value="">กรุณาเลือก</option>
						<option value="monthly">รายเดือน</option>
						<option value="quarter">รายไตรมาส</option>
						<option value="annually">รายปี</option>
					</select>
			  	</div>
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ไตรมาสที่: </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.QuarterFrom" required="required">
						<option value="">กรุณาเลือก..</option>
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
					</select>
			  	</div>
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ปีงบประมาณ: </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.YearFrom" ng-options="year.yearText as year.yearValue for year in YearList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>
			  	<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ถึง </label>
			  	</div>
			  	<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ไตรมาสที่: </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.QuarterTo" required="required">
						<option value="">กรุณาเลือก..</option>
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
					</select>
			  	</div>
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ปีงบประมาณ: </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.YearTo" ng-options="year.yearText as year.yearValue for year in YearList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>
			  	<button class="btn btn-primary" ng-click="goSearch()"><span class="glyphicon glyphicon-search"></span> ค้นหา</button>
			</div>
			<div ng-show="condition.DisplayType == 'annually'">
				<!--<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ภูมิภาค : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.Region" ng-options="region.RegionID as region.RegionName for region in PersonRegion" required="required">
				    	<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>-->
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; การแสดงข้อมูล : </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.DisplayType" ng-change="goSearch()">
						<option value="">กรุณาเลือก</option>
						<option value="monthly">รายเดือน</option>
						<option value="quarter">รายไตรมาส</option>
						<option value="annually">รายปี</option>
					</select>
			  	</div>
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ปีงบประมาณ: </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.YearFrom" ng-options="year.yearText as year.yearValue for year in YearList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>
			  	<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ถึง </label>
			  	</div>
				<div class="form-group">
				    <label for="exampleInputName2">&nbsp; ปีงบประมาณ: </label>
				    &nbsp; <select name="Year" class="form-control" ng-model="condition.YearTo" ng-options="year.yearText as year.yearValue for year in YearList" required="required">
						<option value="">กรุณาเลือก..</option>
					</select>
			  	</div>
			  	<button class="btn btn-primary" ng-click="goSearch()"><span class="glyphicon glyphicon-search"></span> ค้นหา</button>
			</div>
		</form>
	</div>
</div>
<div class="row form-group">
	<div class="col-lg-6 col-lg-offset-3" style=""> 
		<div class="row"  style="background-color: #BD1212; padding: 10px; color: #FFF;border-top:solid 1px #000;border-right:solid 1px #000;border-left:solid 1px #000;">
			<div class="col-lg-12 text-center">
				สรุปข้อมูล
			</div>
		</div>
		<div class="row" style="">
			<div class="col-lg-6" style="padding: 20px; border:solid 1px #000;">
				จำนวนนักท่องเที่ยว &nbsp; {{numberFormat(SummaryData.SummaryCurrentTravelAmount)}}
				<br>
				รายได้จากค่าบริการ &nbsp; {{numberFormatComma(SummaryData.SummaryCurrentTravelIncome)}}
			</div>
			<div class="col-lg-6" style="padding: 20px; border:solid 1px #000;">
				เปอร์เซ็นต์การเติบโตเมื่อเทียบกับปีก่อนหน้า &nbsp; {{numberFormatComma(SummaryData.SummaryTravelAmountPercentage)}} %
				<br>
				เปอร์เซ็นต์การเติบโตเมื่อเทียบกับปีก่อนหน้า &nbsp; {{numberFormatComma(SummaryData.SummaryTravelIncomePercentage)}} %
			</div>
		</div>
	</div>
</div>
<div class="col-lg-12 table-responsive" ng-show="ViewType == 'MAIN'">
	<table class="table table-bordered table-striped">
		<caption class="caption-bg">
			<button class="btn btn-info pull-right" ng-click="ViewType = 'DETAIL'">รายละเอียด</button>
			<button class="btn btn-primary pull-right" ng-click="ViewType = 'MAIN'">ข้อมูลโดยรวม</button>
			
		</caption>
		<thead style="background-color: #BD1212; color: #FFF;">
			<tr>
				
				<th rowspan="2" style="text-align: center; vertical-align: middle;">รายการ</th>
				<th rowspan="2" style="text-align: center; vertical-align: middle;">เดือน</th>
				<th colspan="2" style="text-align: center; vertical-align: middle;">{{CurYear}}</th>
				<th colspan="2" style="text-align: center; vertical-align: middle;">{{LastYear}}</th>
				<th colspan="4" style="text-align: center;">ผลต่าง</th>
				<th rowspan="2" style="text-align: center; vertical-align: middle;">รายละเอียด</th>
			</tr>
			<tr>
				<th style="text-align: center;">ราย</th>
				<th style="text-align: center;">บาท</th>
				<th style="text-align: center;">ราย</th>
				<th style="text-align: center;">บาท</th>
				<th style="text-align: center;">ราย</th>
				<th style="text-align: center;">% เพิ่ม / ลด</th>
				<th style="text-align: center;">บาท</th>
				<th style="text-align: center;">% เพิ่ม / ลด</th>

			</tr>
		</thead>
		<tbody >
			<!--<tr style="background-color: #B6CCFF; padding: 5px;">
				<td colspan="7">{{getRegionName(data.region_id)}}</td>
			</tr>-->
			<tr ng-repeat="data in List">
				<td>{{data.RegionName}}</td>
				<td>{{data.Month}}</td>
				<td>{{numberFormat(data.CurrentAmount)}}</td>
				<td>{{numberFormatComma(data.CurrentBaht)}}</td>
				<td>{{numberFormat(data.BeforeAmount)}}</td>
				<td>{{numberFormatComma(data.BeforeBaht)}}</td>
				<td>{{numberFormat(data.DiffAmount)}}</td>
				<td>{{numberFormatComma(data.DiffAmountPercentage)}}</td>
				<td>{{numberFormatComma(data.DiffBaht)}}</td>
				<td>{{numberFormatComma(data.DiffBahtPercentage)}}</td>
				<td><a class="pull-right" style="padding-right: 20px;" ng-click="exportReport( data,condition)"><img src="../files/img/excel.png" style="height: 40px;"></a></td>
			</tr>
		</tbody>
	</table>
</div>

<div class="col-lg-12 table-responsive" ng-show="ViewType == 'DETAIL'">
	<table class="table table-bordered table-striped">
		<caption>
			<button class="btn btn-info pull-right" ng-click="ViewType = 'DETAIL'">รายละเอียด</button>
			<button class="btn btn-primary pull-right" ng-click="ViewType = 'MAIN'">ข้อมูลโดยรวม</button>
		</caption>
		<thead style="background-color: #BD1212; color: #FFF;">
			<tr>
				<th rowspan="2" style="text-align: center; vertical-align: middle;">วันที่</th>
				<th rowspan="2" style="text-align: center; vertical-align: middle;">หน่วยงานที่เข้าชม</th>
				<th rowspan="2" style="text-align: center; vertical-align: middle;">ส่วนลด</th>
				<th colspan="{{data.unit.length}}" style="text-align: center; vertical-align: middle;" ng-repeat="data in Item">
					{{data.label}}
				</th>
			</tr>
			<tr>
				<th style="text-align: center; vertical-align: middle;" ng-repeat="data in ItemUnit">
					{{data.label}}
				</th>
			</tr>
		</thead>
		<tbody >
			<tr ng-repeat="data in DetailList"">
				<td>{{data.TravelDate}}</td>
				<td>{{data.Organization}}</td>
				<td>{{data.Discount}}</td>
				<td ng-repeat="item in data.ValueList" style="text-align: center; vertical-align: middle;">
					{{item.values}}
				</td>
			</tr>
		</tbody>
		<tr>
			<td>รวม</td>
			<td ng-repeat="data in DetailSummary" style="text-align: center; vertical-align: middle;">
				{{data.values}}
			</td>
		</tr>
	</table>
</div>
<div class="page-header">
&nbsp;
</div>
<style type="text/css">
	a{
		color: #FFF;
	}
</style>